<?xml version="1.0"?>
<configuration>
	<property file="config/main/logging.properties" />
	<property file="config/mycs.properties" />
	<property name="logFolder" value="log/" />
	<property name="time" value="%date{HH:mm:ssXXX}" />
	<property name="date" value="%date{&quot;yyyy-MM-dd'T'HH:mm:ss,SSSXXX&quot;}" />
	<appender name="out_console" class="ch.qos.logback.core.ConsoleAppender">
		<withJansi>true</withJansi>
		<encoder>
			<charset>CP850</charset> <!-- UTF-8 on linux -->
			<Pattern>${time} %highlight(%-5level) %gray([%thread]) - %message%n</Pattern>
		</encoder>
	</appender>
	<appender name="app_console" class="ch.qos.logback.core.FileAppender">
		<file>${logFolder}/server_console.log</file>
		<encoder>
			<charset>UTF-8</charset>
			<Pattern>${date} %-5level [%thread] %logger - %message%n</Pattern>
			<immediateFlush>false</immediateFlush>
		</encoder>
	</appender>
	<appender name="app_warn" class="ch.qos.logback.core.FileAppender">
		<filter class="ch.qos.logback.classic.filter.LevelFilter">
			<level>WARN</level>
			<onMatch>ACCEPT</onMatch>
			<onMismatch>DENY</onMismatch>
		</filter>
		<file>${logFolder}/server_warnings.log</file>
		<encoder>
			<Pattern>${date} %logger - %message%n</Pattern>
		</encoder>
	</appender>
	<appender name="app_error" class="ch.qos.logback.core.FileAppender">
		<filter class="ch.qos.logback.classic.filter.LevelFilter">
			<level>ERROR</level>
			<onMatch>ACCEPT</onMatch>
			<onMismatch>DENY</onMismatch>
		</filter>
		<file>${logFolder}/server_errors.log</file>
		<encoder>
			<Pattern>${date} %logger - %message%n</Pattern>
		</encoder>
	</appender>
	<appender name="app_chat" class="ch.qos.logback.core.FileAppender">
		<file>${logFolder}/chat.log</file>
		<encoder>
			<Pattern>${date} %message%n</Pattern>
		</encoder>
	</appender>
	<appender name="app_chat_discord" class="com.aionemu.commons.logging.DiscordChannelAppender">
		<layout>
			<pattern>%replace(%msg){'\[(.*?) \((.)\)\] (.*?): (.*)', '[$1] $3|${chatserver.log.chat.discord.avatar_url}|$4'}</pattern>
		</layout>
		<webhookUrl>${chatserver.log.chat.discord.webhook_url}</webhookUrl>
		<userName_avatarUrl_msg_separator>\|</userName_avatarUrl_msg_separator>
	</appender>
	<appender name="app_chat_discord_async" class="ch.qos.logback.classic.AsyncAppender">
		<neverBlock>true</neverBlock>
		<appender-ref ref="app_chat_discord" />
	</appender>
	<logger name="CHAT_LOG" additivity="false">
		<appender-ref ref="app_chat" />
		<appender-ref ref="app_chat_discord_async" />
	</logger>
	<root level="INFO">
		<appender-ref ref="out_console" />
		<appender-ref ref="app_console" />
		<appender-ref ref="app_error" />
		<appender-ref ref="app_warn" />
	</root>
</configuration>